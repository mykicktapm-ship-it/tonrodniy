<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>TONRODY Mobile Mock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #05060a;
      --bg-soft: #0b0f16;
      --bg-softer: #101621;
      --accent: #43e7ff;
      --accent-soft: rgba(67, 231, 255, 0.18);
      --danger: #ff4f6a;
      --text: #f5f7ff;
      --muted: #8489a5;
      --border: #1a2233;
      --radius-lg: 18px;
      --radius-md: 12px;
      --nav-height: 64px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", Roboto, sans-serif;
      background: radial-gradient(circle at top, #101628 0, #05060a 55%, #02030a 100%);
      color: var(--text);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app {
      display: flex;
      flex-direction: column;
      height: 100vh;
      max-width: 480px;
      width: 100%;
      background: linear-gradient(180deg, #05060b 0, #05060a 40%, #020307 100%);
    }

    /* HEADER */

    .app-header {
      padding: 10px 14px 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: linear-gradient(135deg, rgba(12,18,32,0.98), rgba(7,10,18,0.98));
      border-bottom: 1px solid rgba(67, 231, 255, 0.18);
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.6);
      z-index: 10;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background:
        radial-gradient(circle at 30% 0, #43e7ff, #1450ff 40%, #050816 80%);
      box-shadow:
        0 0 10px rgba(67, 231, 255, 0.7),
        0 0 25px rgba(0, 120, 255, 0.5);
      position: relative;
      overflow: hidden;
    }

    .logo::after {
      content: "";
      position: absolute;
      inset: 5px;
      border-radius: inherit;
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: 0 0 12px rgba(255,255,255,0.12) inset;
    }

    .logo-text {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.04em;
    }

    .logo-sub {
      font-size: 10px;
      color: var(--muted);
      margin-top: -2px;
    }

    .header-center {
      flex: 1;
      display: flex;
      justify-content: center;
    }

    .header-screen-label {
      font-size: 13px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(12,20,40,0.85);
      border: 1px solid rgba(67, 231, 255, 0.22);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #c3e8ff;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      color: var(--muted);
    }

    .badge-pill {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(11, 20, 40, 0.9);
      border: 1px solid rgba(67, 231, 255, 0.25);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .dot-online {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #43ff91;
      box-shadow: 0 0 8px rgba(67,255,145,0.9);
    }

    /* MAIN */

    .app-main {
      flex: 1;
      padding: 10px 12px 12px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .screen {
      display: none;
      animation: fadeIn 0.25s ease-out;
    }

    .screen.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .section-sub {
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 12px;
    }

    /* PLAY SCREEN */

    .card {
      border-radius: var(--radius-lg);
      background: radial-gradient(circle at top left, rgba(67,231,255,0.08), transparent 60%),
                  radial-gradient(circle at bottom right, rgba(52, 109, 255, 0.16), transparent 60%),
                  var(--bg-soft);
      border: 1px solid var(--border);
      padding: 12px 12px 10px;
      margin-bottom: 10px;
      position: relative;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 13px;
      font-weight: 600;
    }

    .pill {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      color: var(--muted);
    }

    .card-body {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      padding: 8px 14px;
      cursor: pointer;
      outline: none;
      transition: transform 0.08s ease, box-shadow 0.12s ease, background 0.12s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: radial-gradient(circle at top, #43e7ff, #1450ff 60%, #0b1430 100%);
      color: #02030a;
      box-shadow: 0 0 14px rgba(67,231,255,0.7);
      font-weight: 600;
    }

    .btn-primary:active {
      transform: scale(0.97);
      box-shadow: 0 0 6px rgba(67,231,255,0.6);
    }

    .btn-ghost {
      background: rgba(12, 18, 32, 0.9);
      border: 1px solid var(--border);
      color: var(--muted);
    }

    .btn-ghost:active {
      transform: scale(0.97);
    }

    .btn-sm {
      font-size: 11px;
      padding: 5px 10px;
    }

    .btn-icon {
      gap: 6px;
    }

    .chip-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 6px;
    }

    .chip {
      padding: 5px 10px;
      border-radius: 999px;
      background: rgba(9, 14, 26, 0.95);
      border: 1px solid var(--border);
      font-size: 11px;
      color: var(--muted);
      cursor: pointer;
      transition: background 0.1s ease, border-color 0.1s ease, color 0.1s ease, transform 0.08s ease;
    }

    .chip.active {
      background: var(--accent-soft);
      border-color: rgba(67, 231, 255, 0.85);
      color: #e6fbff;
      transform: translateY(-1px);
      box-shadow: 0 0 10px rgba(67,231,255,0.4);
    }

    .inline-meta {
      font-size: 11px;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
    }

    /* COIN ANIMATION */

    .coin-area {
      margin-top: 12px;
      display: none;
      align-items: center;
      flex-direction: column;
      gap: 8px;
    }

    .coin-area.active {
      display: flex;
    }

    .coin {
      width: 72px;
      height: 72px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 0, #ffe26b, #f5b631 40%, #996624 80%);
      box-shadow:
        0 14px 28px rgba(0,0,0,0.7),
        0 0 16px rgba(255,196,76,0.7);
      position: relative;
      transform-style: preserve-3d;
    }

    .coin::before {
      content: "₮";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      font-weight: 700;
      color: #2b1a08;
      text-shadow: 0 0 6px rgba(255,255,255,0.4);
    }

    .coin.flip {
      animation: coinFlip 1.4s cubic-bezier(0.25, 0.7, 0.3, 1.0);
    }

    @keyframes coinFlip {
      0%   { transform: rotateY(0deg) translateY(0); }
      30%  { transform: rotateY(360deg) translateY(-8px); }
      60%  { transform: rotateY(720deg) translateY(-4px); }
      100% { transform: rotateY(1080deg) translateY(0); }
    }

    .status-text {
      font-size: 12px;
      color: var(--muted);
    }

    .status-text strong {
      color: #e6fbff;
    }

    .status-pulse {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px rgba(67,231,255,0.9);
      animation: pulse 1.3s ease-in-out infinite;
    }

    @keyframes pulse {
      0%   { transform: scale(0.9); opacity: 0.9; }
      50%  { transform: scale(1.25); opacity: 1; }
      100% { transform: scale(0.9); opacity: 0.9; }
    }

    .status-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 4px;
    }

    /* LOBBIES */

    .filter-row {
      display: flex;
      gap: 6px;
      overflow-x: auto;
      padding-bottom: 4px;
      margin-bottom: 8px;
    }

    .filter-chip {
      padding: 4px 10px;
      font-size: 11px;
      border-radius: 999px;
      background: rgba(9,13,24,0.95);
      border: 1px solid var(--border);
      white-space: nowrap;
      color: var(--muted);
      cursor: pointer;
    }

    .filter-chip.active {
      background: rgba(67,231,255,0.16);
      border-color: rgba(67,231,255,0.85);
      color: #e6fbff;
    }

    .lobby-card {
      border-radius: var(--radius-md);
      background: var(--bg-soft);
      border: 1px solid var(--border);
      padding: 10px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .lobby-main {
      flex: 1;
    }

    .lobby-title {
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 2px;
    }

    .lobby-meta {
      font-size: 11px;
      color: var(--muted);
    }

    .lobby-tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .lobby-tag {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(10,16,28,0.95);
      border: 1px solid var(--border);
      color: var(--muted);
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
    }

    .status-dot.green {
      background: #43ff91;
      box-shadow: 0 0 10px rgba(67,255,145,0.9);
    }

    .status-dot.yellow {
      background: #ffd75a;
      box-shadow: 0 0 8px rgba(255,215,90,0.9);
    }

    .status-dot.red {
      background: #ff4f6a;
      box-shadow: 0 0 8px rgba(255,79,106,0.9);
    }

    /* BOTTOM NAV */

    .bottom-nav {
      height: var(--nav-height);
      border-top: 1px solid rgba(11,20,40,0.95);
      background: radial-gradient(circle at top, rgba(67,231,255,0.16), transparent 55%),
                  rgba(3,5,12,0.98);
      display: flex;
      align-items: center;
      justify-content: space-around;
      padding-bottom: env(safe-area-inset-bottom);
    }

    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
      font-size: 10px;
      color: var(--muted);
      cursor: pointer;
      padding-top: 4px;
    }

    .nav-icon {
      width: 20px;
      height: 20px;
      border-radius: 999px;
      border: 1px solid rgba(132,137,165,0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
    }

    .nav-item.active .nav-icon {
      border-color: rgba(67,231,255,0.9);
      box-shadow: 0 0 10px rgba(67,231,255,0.7);
      background: rgba(6,18,36,0.95);
      color: #e6fbff;
    }

    .nav-item.active span {
      color: #e6fbff;
    }

    /* MODAL */

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(2, 4, 12, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 40;
    }

    .modal-backdrop.active {
      display: flex;
    }

    .modal {
      width: 92%;
      max-width: 380px;
      padding: 14px 14px 10px;
      border-radius: 18px;
      background: radial-gradient(circle at top, rgba(67,231,255,0.14), transparent 60%),
                  #060814;
      border: 1px solid rgba(67,231,255,0.3);
      box-shadow: 0 18px 40px rgba(0,0,0,0.88);
    }

    .modal-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .modal-body {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .modal-row {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      margin-bottom: 4px;
    }

    .modal-footer {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .badge-soft {
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 10px;
      background: rgba(12, 18, 32, 0.9);
      border: 1px solid var(--border);
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    /* SMALL HELPERS */

    .mt-4 { margin-top: 4px; }
    .mt-6 { margin-top: 6px; }
    .mt-10 { margin-top: 10px; }
    .text-muted { color: var(--muted); font-size: 11px; }
    .text-center { text-align: center; }

  </style>
</head>
<body>
<div class="app">
  <header class="app-header">
    <div class="header-left">
      <div class="logo"></div>
      <div>
        <div class="logo-text">TONRODY</div>
        <div class="logo-sub">Arena of Luck</div>
      </div>
    </div>
    <div class="header-center">
      <div id="headerScreenLabel" class="header-screen-label">PLAY</div>
    </div>
    <div class="header-right">
      <div class="badge-pill">
        <div class="status-dot green"></div>
        <span>Mainnet</span>
      </div>
      <div class="badge-pill">
        <span>◎</span>
        <span id="walletBalance">0.00 TON</span>
      </div>
    </div>
  </header>

  <main class="app-main">
    <!-- PLAY SCREEN -->
    <section id="screen-play" class="screen active">
      <div class="section-title">Быстрый старт</div>
      <div class="section-sub">Выбери режим и ставку, остальное сделает контракт.</div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Quick Coin Flip 1v1</div>
            <div class="text-muted">Дуэль на удачу между двумя игроками.</div>
          </div>
          <div class="pill">1 v 1</div>
        </div>
        <div class="card-body">
          Победитель забирает весь пул. Платформа не участвует, только контракт и чистый рандом.
        </div>
        <button id="btnQuickFlip" class="btn btn-primary btn-icon">
          <span>Быстрый Coin Flip</span>
        </button>
        <div class="inline-meta">
          <span>Ставка: <strong id="quickFlipStakeLabel">1 TON</strong></span>
          <span class="text-muted">Игроков: 2</span>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Fast Lobby</div>
            <div class="text-muted">Классическое лобби с N игроками.</div>
          </div>
          <div class="pill">LOBBY</div>
        </div>
        <div class="card-body">
          Все вносят одинаковую ставку, один победитель забирает всё.
        </div>
        <div class="inline-meta">
          <span>Игроков: <strong id="fastLobbyPlayersLabel">5</strong></span>
          <button id="btnTogglePlayers" class="btn btn-ghost btn-sm">5 / 10</button>
        </div>
        <button id="btnFastLobby" class="btn btn-primary btn-icon mt-6">
          <span>Быстрое лобби</span>
        </button>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Ставка</div>
          <div class="pill">TON</div>
        </div>
        <div class="card-body">
          Выбери размер ставки, которая будет использоваться для быстрых режимов.
        </div>
        <div class="chip-row" id="stakeChips">
          <div class="chip active" data-value="0.5">0.5 TON</div>
          <div class="chip" data-value="1">1 TON</div>
          <div class="chip" data-value="2">2 TON</div>
          <div class="chip" data-value="5">5 TON</div>
        </div>

        <div id="coinArea" class="coin-area">
          <div id="coin" class="coin"></div>
          <div class="status-text" id="coinStatus">Готов к запуску.</div>
          <div class="status-row">
            <div class="status-pulse"></div>
            <div class="status-text" id="coinSubStatus">Нажми режим, чтобы начать раунд.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- LOBBIES SCREEN -->
    <section id="screen-lobbies" class="screen">
      <div class="section-title">Лобби</div>
      <div class="section-sub">Публичные комнаты, Coin Flip и спец-режимы.</div>

      <div class="filter-row">
        <div class="filter-chip active" data-filter="all">Все</div>
        <div class="filter-chip" data-filter="coin">Coin Flip</div>
        <div class="filter-chip" data-filter="classic">Classic</div>
        <div class="filter-chip" data-filter="high">High Stakes</div>
        <div class="filter-chip" data-filter="private">Private</div>
      </div>

      <div id="lobbiesList"></div>
    </section>

    <!-- DONATEROOM SCREEN -->
    <section id="screen-donateroom" class="screen">
      <div class="section-title">Donateroom</div>
      <div class="section-sub">Шоу-комнаты с донатом и эффектами. Донат не влияет на шанс выигрыша.</div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Bazooka Room</div>
            <div class="text-muted">Проигравший ловит визуальную базуку в аватар.</div>
          </div>
          <div class="pill">DONATE</div>
        </div>
        <div class="card-body">
          Ставка: 1 TON · Донат: 0.1 TON<br/>
          Пул: N × 1 TON · Донат проекта: N × 0.1 TON
        </div>
        <button class="btn btn-primary btn-sm btn-icon">
          <span>Войти в Bazooka Room</span>
        </button>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Legendary Lobby</div>
            <div class="text-muted">Редкие эффекты, кастомный звук победы.</div>
          </div>
          <div class="pill">DONATE</div>
        </div>
        <div class="card-body">
          Ставка: 2 TON · Донат: 0.25 TON
        </div>
        <button class="btn btn-primary btn-sm btn-icon">
          <span>Войти в Legendary Lobby</span>
        </button>
      </div>
    </section>

    <!-- YOU SCREEN -->
    <section id="screen-you" class="screen">
      <div class="section-title">Ты</div>
      <div class="section-sub">Профиль, статы, токены и резонанс.</div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Профиль</div>
            <div class="text-muted">Telegram-аватар, адрес кошелька, статус.</div>
          </div>
        </div>
        <div class="card-body">
          <div class="modal-row">
            <span>Адрес TON</span>
            <span class="text-muted">EQxxxxxxxx…</span>
          </div>
          <div class="modal-row">
            <span>Баланс TON</span>
            <span class="text-muted">0.00 TON</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">TNRD токен</div>
          <div class="pill">LOCKER</div>
        </div>
        <div class="card-body">
          <div class="modal-row">
            <span>Locked</span>
            <span class="text-muted">1250 TNRD</span>
          </div>
          <div class="modal-row">
            <span>Доступно</span>
            <span class="text-muted">0 TNRD</span>
          </div>
          <div class="modal-row">
            <span>Цена</span>
            <span class="text-muted">$0.42 / Unlock at $1.00</span>
          </div>
          <button class="btn btn-ghost btn-sm mt-6">Подробнее о разлоке</button>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Статистика</div>
          <div class="pill">STATS</div>
        </div>
        <div class="card-body">
          <div class="modal-row">
            <span>Сыграно раундов</span>
            <span class="text-muted">37</span>
          </div>
          <div class="modal-row">
            <span>Побед</span>
            <span class="text-muted">18</span>
          </div>
          <div class="modal-row">
            <span>Win rate</span>
            <span class="text-muted">48.6%</span>
          </div>
        </div>
      </div>
    </section>

    <!-- HISTORY SCREEN -->
    <section id="screen-history" class="screen">
      <div class="section-title">История</div>
      <div class="section-sub">Последние сыгранные раунды.</div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Недавние раунды</div>
        </div>
        <div class="card-body">
          <div class="text-muted">
            Здесь позже будет список последних Coin Flip и лобби с результатами.
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- BOTTOM NAV -->
  <nav class="bottom-nav">
    <div class="nav-item active" data-screen="play">
      <div class="nav-icon">▶</div>
      <span>Play</span>
    </div>
    <div class="nav-item" data-screen="lobbies">
      <div class="nav-icon">▢</div>
      <span>Lobbies</span>
    </div>
    <div class="nav-item" data-screen="donateroom">
      <div class="nav-icon">★</div>
      <span>Donateroom</span>
    </div>
    <div class="nav-item" data-screen="you">
      <div class="nav-icon">☺</div>
      <span>You</span>
    </div>
    <div class="nav-item" data-screen="history">
      <div class="nav-icon">⧉</div>
      <span>History</span>
    </div>
  </nav>
</div>

<!-- CONFIRM MODAL -->
<div id="modalBackdrop" class="modal-backdrop">
  <div class="modal">
    <div class="modal-title">Подтвердить раунд</div>
    <div class="modal-body">
      <div class="modal-row">
        <span>Режим</span>
        <span id="modalModeLabel" class="text-muted"></span>
      </div>
      <div class="modal-row">
        <span>Ставка</span>
        <span id="modalStakeLabel" class="text-muted"></span>
      </div>
      <div class="modal-row">
        <span>Игроков</span>
        <span id="modalPlayersLabel" class="text-muted"></span>
      </div>

      <div class="badge-soft mt-6">
        <span>ℹ</span>
        <span>Это UI-мок. Здесь позже будет вызов контракта и TON Connect.</span>
      </div>
    </div>
    <div class="modal-footer">
      <button id="btnModalCancel" class="btn btn-ghost btn-sm" style="flex: 1;">Отмена</button>
      <button id="btnModalConfirm" class="btn btn-primary btn-sm" style="flex: 1;">Запустить</button>
    </div>
  </div>
</div>

<script>
  // Навигация по вкладкам
  const screens = {
    play: document.getElementById('screen-play'),
    lobbies: document.getElementById('screen-lobbies'),
    donateroom: document.getElementById('screen-donateroom'),
    you: document.getElementById('screen-you'),
    history: document.getElementById('screen-history'),
  };

  const headerLabel = document.getElementById('headerScreenLabel');

  document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', () => {
      const target = item.getAttribute('data-screen');

      // активная навигация
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      item.classList.add('active');

      // переключение экранов
      Object.entries(screens).forEach(([key, el]) => {
        el.classList.toggle('active', key === target);
      });

      headerLabel.textContent = target.toUpperCase();
    });
  });

  // Ставки (чипы)
  let currentStake = 0.5;
  const stakeChips = document.getElementById('stakeChips');
  const quickFlipStakeLabel = document.getElementById('quickFlipStakeLabel');

  stakeChips.addEventListener('click', (e) => {
    const chip = e.target.closest('.chip');
    if (!chip) return;
    const value = parseFloat(chip.getAttribute('data-value'));

    currentStake = value;

    document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
    chip.classList.add('active');

    quickFlipStakeLabel.textContent = value + ' TON';
  });

  // Быстрый Coin Flip / Fast Lobby
  const btnQuickFlip = document.getElementById('btnQuickFlip');
  const btnFastLobby = document.getElementById('btnFastLobby');
  const btnTogglePlayers = document.getElementById('btnTogglePlayers');
  const fastLobbyPlayersLabel = document.getElementById('fastLobbyPlayersLabel');

  let fastLobbyPlayers = 5;

  btnTogglePlayers.addEventListener('click', () => {
    fastLobbyPlayers = fastLobbyPlayers === 5 ? 10 : 5;
    fastLobbyPlayersLabel.textContent = fastLobbyPlayers.toString();
    btnTogglePlayers.textContent = fastLobbyPlayers === 5 ? '5 / 10' : '10 / 5';
  });

  // Модалка подтверждения
  const modalBackdrop = document.getElementById('modalBackdrop');
  const modalModeLabel = document.getElementById('modalModeLabel');
  const modalStakeLabel = document.getElementById('modalStakeLabel');
  const modalPlayersLabel = document.getElementById('modalPlayersLabel');
  const btnModalCancel = document.getElementById('btnModalCancel');
  const btnModalConfirm = document.getElementById('btnModalConfirm');

  let pendingMode = null;

  function openConfirmModal(mode, stake, players) {
    pendingMode = mode;
    modalModeLabel.textContent = mode;
    modalStakeLabel.textContent = stake + ' TON';
    modalPlayersLabel.textContent = players;
    modalBackdrop.classList.add('active');
  }

  btnQuickFlip.addEventListener('click', () => {
    openConfirmModal('Coin Flip 1v1', currentStake, '2');
  });

  btnFastLobby.addEventListener('click', () => {
    openConfirmModal('Lobby', currentStake, fastLobbyPlayers.toString());
  });

  btnModalCancel.addEventListener('click', () => {
    modalBackdrop.classList.remove('active');
    pendingMode = null;
  });

  // Анимация монеты и мок "запуска раунда"
  const coinArea = document.getElementById('coinArea');
  const coin = document.getElementById('coin');
  const coinStatus = document.getElementById('coinStatus');
  const coinSubStatus = document.getElementById('coinSubStatus');

  btnModalConfirm.addEventListener('click', () => {
    modalBackdrop.classList.remove('active');
    if (!pendingMode) return;

    // показать зону монеты, если скрыта
    coinArea.classList.add('active');

    // статус ожидания/запуска
    coinStatus.innerHTML = 'Запускаем раунд: <strong>' + pendingMode + '</strong>';
    coinSubStatus.textContent = 'Отправка транзакции в сеть TON (мок).';

    // имитация маленькой задержки, затем анимация
    setTimeout(() => {
      coin.classList.remove('flip'); // сброс анимации
      void coin.offsetWidth;        // хак для перезапуска
      coin.classList.add('flip');

      coinStatus.innerHTML = 'Определяем победителя…';
      coinSubStatus.textContent = 'Рандом крутится, контракт ждёт результат.';

      // через 1.5s "результат"
      setTimeout(() => {
        const win = Math.random() > 0.5;
        if (win) {
          coinStatus.innerHTML = 'Ты <strong>выиграл</strong> раунд.';
          coinSubStatus.textContent = 'Пул будет отправлен на твой адрес кошелька (в проде).';
        } else {
          coinStatus.innerHTML = 'Ты <strong>проиграл</strong> раунд.';
          coinSubStatus.textContent = 'В следующий раз удача может сместиться в твою сторону.';
        }
      }, 1500);
    }, 200);

    pendingMode = null;
  });

  // Моки лобби
  const lobbiesList = document.getElementById('lobbiesList');
  const lobbyData = [
    { id: 1, title: 'Coin Flip • 1 TON', type: 'coin', players: '1 / 2', mode: 'Public', status: 'filling' },
    { id: 2, title: 'Lobby 10 игроков • 0.5 TON', type: 'classic', players: '7 / 10', mode: 'Public', status: 'almost' },
    { id: 3, title: 'High Stakes • 5 TON', type: 'high', players: '10 / 10', mode: 'Donate', status: 'running' },
    { id: 4, title: 'Private Lobby • 1 TON', type: 'private', players: '3 / 5', mode: 'Private', status: 'filling' },
  ];

  function renderLobbies(filter = 'all') {
    lobbiesList.innerHTML = '';

    lobbyData
      .filter(l => filter === 'all' || l.type === filter)
      .forEach(lobby => {
        const card = document.createElement('div');
        card.className = 'lobby-card';

        const main = document.createElement('div');
        main.className = 'lobby-main';

        const title = document.createElement('div');
        title.className = 'lobby-title';
        title.textContent = lobby.title;

        const meta = document.createElement('div');
        meta.className = 'lobby-meta';
        meta.textContent = `Игроков: ${lobby.players}`;

        const tags = document.createElement('div');
        tags.className = 'lobby-tag-row';

        const modeTag = document.createElement('div');
        modeTag.className = 'lobby-tag';
        modeTag.textContent = lobby.mode;

        tags.appendChild(modeTag);

        main.appendChild(title);
        main.appendChild(meta);
        main.appendChild(tags);

        const right = document.createElement('div');
        right.style.display = 'flex';
        right.style.flexDirection = 'column';
        right.style.alignItems = 'flex-end';
        right.style.gap = '6px';

        const dot = document.createElement('div');
        dot.className = 'status-dot ' + (
          lobby.status === 'filling' ? 'green' :
          lobby.status === 'almost' ? 'yellow' : 'red'
        );

        const btn = document.createElement('button');
        btn.className = 'btn btn-ghost btn-sm';
        if (lobby.status === 'running') {
          btn.textContent = 'Watch';
        } else if (lobby.players.startsWith('1 /') || lobby.players.startsWith('0 /')) {
          btn.textContent = 'Join';
        } else {
          btn.textContent = 'Join';
        }

        btn.addEventListener('click', () => {
          // Пока просто подсветка — сюда потом прилепится логика входа в лобби.
          btn.textContent = 'Joined';
        });

        right.appendChild(dot);
        right.appendChild(btn);

        card.appendChild(main);
        card.appendChild(right);

        lobbiesList.appendChild(card);
      });
  }

  renderLobbies();

  // фильтры лобби
  document.querySelectorAll('.filter-chip').forEach(chip => {
    chip.addEventListener('click', () => {
      document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
      chip.classList.add('active');
      const filter = chip.getAttribute('data-filter');
      renderLobbies(filter);
    });
  });
</script>
</body>
</html>
